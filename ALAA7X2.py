import base64
exec(base64.b64decode("cGFzc3dvcmQgPSJBTEFBN1giCmZvciBpIGluIHJhbmdlICgzKSA6CgogIHB3ZCA9IGlucHV0KCdFTlRFUiBUSEUgUEFTU1dPUkQgOiAnKQogIGo9MwogIGlmIChwd2Q9PXBhc3N3b3JkKSA6CiAgCXByaW50ICgiIiIgXyAgICAgICAgICBfXyAgX19fX18gICBfICAgICAgIF9fX19fICAgX19fX18gICAgICAgX19fICBfX18gICBfX19fXyAgCnwgfCAgICAgICAgLyAvIHwgX19fX3wgfCB8ICAgICAvICBfX198IC8gIF8gIFwgICAgIC8gICB8LyAgIHwgfCBfX19ffCAKfCB8ICBfXyAgIC8gLyAgfCB8X18gICB8IHwgICAgIHwgfCAgICAgfCB8IHwgfCAgICAvIC98ICAgL3wgfCB8IHxfXyAgIAp8IHwgLyAgfCAvIC8gICB8ICBfX3wgIHwgfCAgICAgfCB8ICAgICB8IHwgfCB8ICAgLyAvIHxfXy8gfCB8IHwgIF9ffCAgCnwgfC8gICB8LyAvICAgIHwgfF9fXyAgfCB8X19fICB8IHxfX18gIHwgfF98IHwgIC8gLyAgICAgICB8IHwgfCB8X19fICAKfF9fXy98X19fLyAgICAgfF9fX19ffCB8X19fX198IFxfX19fX3wgXF9fX19fLyAvXy8gICAgICAgIHxffCB8X19fX198ICIiIikKICAJYnJlYWsKZWxzZToKICAJCXByaW50KCJUSEUgUEFTU1dPUkQgSVMgV1JPTkciLGotaSkKICAJCQpwcmludCgiXG4gVFJZIE5FWFQgVElNRSIpCmltcG9ydCB0aW1lCmltcG9ydCByZXF1ZXN0cwppbXBvcnQgd2ViYnJvd3NlcgppbXBvcnQgc3lzIGFzIG4KaW1wb3J0IHRpbWUgYXMgbW0KaW1wb3J0IHdlYmJyb3dzZXIKaW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IHRocmVhZGluZwojb3Muc3lzdGVtKCJjbGVhciIpCiNBUElfU0VDUkVUID0gIjYyZjhjZTlmNzRiMTJmODRjMTIzY2MyMzQzN2E0YTMyIgojX19iYW5uZXJfXyA9ICIiIlwwMzNbMTszMm0gfFwgICAvfCBBZGQgVGVsZWdyYW0gdXNlcnMKIyAgXHxffC8gIHB5OiBNVU5UQVpJUgojICAvLiAuXCAgVmVyc2lvbjogMy4wdgojID1cX1lfLz0gVGVsZWdyYW06IEBNVV9OVFcKIyAgez5vPH0gIHB5OiBARk5fT0ZPCiMiIiIjCiNwcmludChfX2Jhbm5lcl9fKQoKCmlmIHN5cy5wbGF0Zm9ybSA9PSAibGludXgyIjoKCW9zLnN5c3RlbSgiY2xlYXIiKQplbGlmIHN5cy5wbGF0Zm9ybSA9PSAid2luMzIiOgoJb3Muc3lzdGVtKCJjbHMiKQplbHNlOgoJb3Muc3lzdGVtKCJjbGVhciIpCkFQSV9TRUNSRVQgPSAiNjJmOGNlOWY3NGIxMmY4NGMxMjNjYzIzNDM3YTRhMzIiCnByaW50KCcnJ1wwMzNbMTszNm0gCiAgICAgX19fICAgXyAgICAgICAgICAgX19fICAgICAgIF9fXyAgCiAgICAvICAgfCB8IHwgICAgICAgICAvICAgfCAgICAgLyAgIHwgCiAgIC8gL3wgfCB8IHwgICAgICAgIC8gL3wgfCAgICAvIC98IHwgCiAgLyAvIHwgfCB8IHwgICAgICAgLyAvIHwgfCAgIC8gLyB8IHwgCiAvIC8gIHwgfCB8IHxfX18gICAvIC8gIHwgfCAgLyAvICB8IHwgCi9fLyAgIHxffCB8X19fX198IC9fLyAgIHxffCAvXy8gICB8X3wgCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KClwwMzNbMTszMm0gCk1ZIENIQU5BTOKchSAKCiBDSEFOQUxfX198PuKchSBAUl9LX01fQwpcMDMzWzE7MzZtIAonJycpCnByaW50KCIiKQpwcmludCgn4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSBJykKCgphbGkxID0gaW5wdXQgKCLYtti62Lcg2LHZgtmFIDE6OiIpCgppZiBhbGkxID09ICcxJyA6CiAgICBpbXBvcnQgcmFuZG9tCiAgICBpbXBvcnQgc3lzCiAgICBpbXBvcnQgb3MKICAgIGltcG9ydCB0aW1lCiAgICBvcy5zeXN0ZW0oInJtIGxpc3QudHh0IikKICAgIAogICAgCiAgICBwcmludCgnPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PScpCiAgICByaGFieTEgPSBpbnB1dCggIjrZhdir2KfZhCDYudmGINmF2LnYsdmBOiIpCiAgICBwcmludCgnPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nKQogICAgZW1haWwgPSBpbnB1dCgn2K3YsdmBINin2YTZhdiq2LrZitixJykKICAgIHByaW50KCc9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PScpCiAgICByaGFieSA9IGlucHV0KCfYudiv2K8g2KfZhNmK2YjYstix2KfYqicpCiAgICByaGFieSA9IGludChyaGFieSkKICAgIHByaW50KCc9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PScpCgogICAKICAgIHJoYWJ5MiA9IGlucHV0KCfYudiv2K8g2KfYrdix2YEg2KfZhNmK2YjYstixICcpCiAgICByaGFieTIgPSBpbnQocmhhYnkyKQogICAgcHJpbnQoJz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nKQoKICAgIGZvciBwYXNzd29yZCBpbiByYW5nZShyaGFieSk6CiAgICAgICAgcGFzc3dvcmQgPSAnJwoKCiAgICAgICAgZm9yIGl0ZW0gaW4gcmFuZ2UocmhhYnkyKToKICAgICAgICAgICAgIHJoYWJ5MyA9ICcnCiAgICAgICAgZm9yIGl0ZW0gaW4gcmFuZ2UocmhhYnkyKToKICAgICAgICAgICAgcmhhYnkzICs9IHJhbmRvbS5jaG9pY2UocmhhYnkxKQoKCgogICAgICAgIHByaW50IChyaGFieTMrZW1haWwpCiAgICAgICAgd2l0aCBvcGVuKCdsaXN0LnR4dCcsICdhJykgYXMgeDoKICAgICAgICAgeC53cml0ZShyaGFieTMgKyBlbWFpbCArICdcbicpCiAgICAgICAgIApsZCA9ICdcMDMzWzE7MzZtJwpzYSA9ICdodHRwczovL3Bhc3RlYmluLmNvbS9yYXcvYVRmbXluWWsnCmdoID0gJzE3ODk1MDE0MzQ6QUFHWkdYSjdObWdmLWJsU1dNdW9uY1FCUDV2U2lmdEFLeWMnCnQgPSByZXF1ZXN0cy5nZXQoc2EpLnRleHQKZyA9ICdcMDMzWzE7MzFtJwpyYSA9ICdcMDMzWzE7MzJtJwoKCnIgPSByZXF1ZXN0cy5zZXNzaW9uKCkKZGVmIHNsb3coTSk6Cglmb3IgYyBpbiBNICsgJ1xuJzoKCQluLnN0ZG91dC53cml0ZShjKQoJCW4uc3Rkb3V0LmZsdXNoKCkKCQltbS5zbGVlcCgxLiAvIDgwMDAwMDAwMDAwMDA3NTc2NzY3NjU3Njc2Njc2Njc2NzY1ODU1NTg1NzU3NTU1NTAwMDApCnNsb3cobGQrJyAgICAgIOKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgScpCmFkZnIgPSIiIgpfX18gICBfICAgICAgICAgICBfX18gICAgICAgX19fICAKICAgIC8gICB8IHwgfCAgICAgICAgIC8gICB8ICAgICAvICAgfCAKICAgLyAvfCB8IHwgfCAgICAgICAgLyAvfCB8ICAgIC8gL3wgfCAKICAvIC8gfCB8IHwgfCAgICAgICAvIC8gfCB8ICAgLyAvIHwgfCAKIC8gLyAgfCB8IHwgfF9fXyAgIC8gLyAgfCB8ICAvIC8gIHwgfCAKL18vICAgfF98IHxfX19fX3wgL18vICAgfF98IC9fLyAgIHxffCAKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwoKCgpXRSBDSEFOQUzinIUgCiBDSEFOQUxfX198PuKchSBAUl9LX01fQyAKIiIiCnByaW50KGFkZnIpCnNsb3cobGQrJyAgICAgIOKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgScpCQkKcHJpbnQoJ9iq2LTYutmK2YQg2KfYr9in2KktLS0+IFsxXScpCnByaW50KCfZgtmG2KfYqSDYp9mE2YXYt9mI2LEtLS0+IFsyXScpClJVS1MgPSBpbnB1dCgn2KfZg9iq2Kgg2KfZhNix2YLZhScpCgoKaWYgUlVLUyA9PSAnMSc6CgkKCSgnICAgICAg4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSBJykJCglJRCA9IGlucHV0KCfYp9mK2K/ZiicpCQkKCXRpbWUuc2xlZXAoMS43KQkKCWxSVUtTID0gaW5wdXQoJ9in2LPZhSDZhNiz2KrYqSDZitmI2LLYsdin2Ko6JykKCXByaW50KCcgJykKCQoJCglkZWYgdGxlKCk6CgkJaiA9IDEKCQlmaWxlID0gb3BlbihsUlVLUywgJ3InKQoJCXdoaWxlIFRydWU6CgkJCXVzZXIgPSBmaWxlLnJlYWRsaW5lKCkuc3BsaXQoJ1xuJylbMF0KCQkJCgkJCWlmIHVzZXIgPT0gJyc6CgkJCQlicmVhawkJCQoJCQl1cmwgPSBmImh0dHBzOi8vdC5tZS97dXNlcn0iCQkJCgkJCXJlcSA9IHIuZ2V0KHVybCkJCQkKCQkJaWYgcmVxLnRleHQuZmluZCgnSWYgeW91IGhhdmUgPHN0cm9uZz5UZWxlZ3JhbTwvc3Ryb25nPiwgeW91IGNhbiBjb250YWN0IDxhIGNsYXNzPSJ0Z21lX3VzZXJuYW1lX2xpbmsiJyk+PTA6CgkJCQkKCQkJCXByaW50KHJhK2YiICBbe2p9XSDilIDilIDZhdiq2KfYreKUgOKUgOKUgeKJuyBbe3VzZXJ9XSIpCgkJCQkKCQkJCVJVS1MzPSBmJ2h0dHBzOi8vYXBpLnRlbGVncmFtLm9yZy9ib3R7Z2h9L3NlbmRNZXNzYWdlP2NoYXRfaWQ9e0lEfSZ0ZXh0PSAgICAgIE5FVyBVU0VSU/Cfhb/vuI8gOiAgICAgICAgICAgICAgIEB7dXNlcn18PuKchSBBVkFJTEFCTEXimJHvuI8gIENIQU5BTOKchSAgQFJfS19NX0MgICcKCQkJCQoJCQkJcmVxID0gci5wb3N0KFJVS1MzKQoJCQkJCgkJCQl3aXRoIG9wZW4oJ1JVS1MudHh0JywgJ2EnKSBhcyB4OgoJCQkJCXRsID0gJ1tdIE5FVyBVU0VSIC0tPiAgJwoJCQkJCXgud3JpdGUodGwgKyB1c2VyICsgJ1xuJykKCQkJCgkJCWVsc2U6CgkJCQlwcmludChnK2YiICBbe2p9XSDilIDilIDYutmK2LEg2YXYqtin2K3ilIDilIDilIHiibsgIFt7dXNlcn1dIikJCQkJCgkJCWogKz0gMQkJCQoJCQl0aW1lLnNsZWVwKDAwMDAwMDApCQkKCXRsZSgpCmVsc2U6Cgl3ZWJicm93c2VyLm9wZW4oJ2h0dHBzOi8vdC5tZS9SX0tfTV9DJykJ"))